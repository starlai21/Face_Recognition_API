# Face Recognition



[TOC]



## 人脸检测

------

/face/detect

检测请求图片中的人脸，返回人脸位置

**请求参数**

| 参数         | 必选 | 类型   | 说明                                                         |
| ------------ | ---- | ------ | ------------------------------------------------------------ |
| image        | 是   | string | 图片信息(**总数据大小应小于10M**)，图片上传方式根据image_type来判断 |
| image_type   | 是   | string | 图片类型 **BASE64**:图片的base64值，base64编码后的图片数据，编码后的图片大小不超过2M； **URL**:图片的 URL地址( 可能由于网络等原因导致下载图片时间过长)； **FACE_TOKEN**: 人脸图片的唯一标识，调用人脸检测接口时，会为每个人脸图片赋予一个唯一的FACE_TOKEN，同一张图片多次检测得到的FACE_TOKEN是同一个。 |
| max_face_num | 否   | uint32 | 最多处理人脸的数目，默认值为1，仅检测图片中面积最大的那个人脸；**最大值10**，检测图片中面积最大的几张人脸。 |
| face_type    | 否   | string | 人脸的类型 **LIVE**表示生活照：通常为手机、相机拍摄的人像图片、或从网络获取的人像图片等 **IDCARD**表示身份证芯片照：二代身份证内置芯片中的人像照片 **WATERMARK**表示带水印证件照：一般为带水印的小图，如公安网小图 **CERT**表示证件照片：如拍摄的身份证、工卡、护照、学生证等证件图片 默认**LIVE** |

## 人脸比对

------

/face/match

**两张人脸图片相似度对比**：比对两张图片中人脸的相似度，并返回相似度分值

**请求参数**

| 参数       | 必选 | 类型   | 说明                                                         |
| ---------- | ---- | ------ | ------------------------------------------------------------ |
| image      | 是   | string | 图片信息(**总数据大小应小于10M**)，图片上传方式根据image_type来判断。 **两张图片通过json格式上传，格式参考表格下方示例** |
| image_type | 是   | string | 图片类型 **BASE64**:图片的base64值，base64编码后的图片数据，编码后的图片大小不超过2M； **URL**:图片的 URL地址( 可能由于网络等原因导致下载图片时间过长)； **FACE_TOKEN**: 人脸图片的唯一标识，调用人脸检测接口时，会为每个人脸图片赋予一个唯一的FACE_TOKEN，同一张图片多次检测得到的FACE_TOKEN是同一个。 |
| face_type  | 否   | string | 人脸的类型 **LIVE**：表示生活照：通常为手机、相机拍摄的人像图片、或从网络获取的人像图片等， **IDCARD**：表示身份证芯片照：二代身份证内置芯片中的人像照片， **WATERMARK**：表示带水印证件照：一般为带水印的小图，如公安网小图 **CERT**：表示证件照片：如拍摄的身份证、工卡、护照、学生证等证件图片 默认LIVE |

## 人脸搜索

------

/face/search

**1：N人脸搜索**：也称为1：N识别，在指定人脸集合中，找到最相似的人脸；

**1：N人脸认证**：基于uid维度的1：N识别，由于uid已经锁定固定数量的人脸，所以检索范围更聚焦；

> **1：N人脸识别**与**1：N人脸认证**的差别在于：人脸搜索是在指定人脸集合中进行直接地人脸检索操作，而人脸认证是基于uid，先调取这个uid对应的人脸，再在这个uid对应的人脸集合中进行检索（因为每个uid通常对应的只有一张人脸，所以通常也就变为了1：1对比）；实际应用中，人脸认证需要用户或系统先输入id，这增加了验证安全度，但也增加了复杂度，具体使用哪个接口需要视您的业务场景判断。 

**请求参数**

| 参数          | 必选 | 类型   | 说明                                                         |
| ------------- | ---- | ------ | ------------------------------------------------------------ |
| image         | 是   | string | 图片信息(**总数据大小应小于10M**)，图片上传方式根据image_type来判断 |
| image_type    | 是   | string | 图片类型 **BASE64**:图片的base64值，base64编码后的图片数据，编码后的图片大小不超过2M； **URL**:图片的 URL地址( 可能由于网络等原因导致下载图片时间过长)； **FACE_TOKEN**: 人脸图片的唯一标识，调用人脸检测接口时，会为每个人脸图片赋予一个唯一的FACE_TOKEN，同一张图片多次检测得到的FACE_TOKEN是同一个。 |
| group_id_list | 是   | string | 从指定的group中进行查找 用逗号分隔，**上限10个**             |
| user_id       | 否   | string | 当需要对特定用户进行比对时，指定user_id进行比对。即人脸认证功能。 |
| max_user_num  | 否   | unit32 | 查找后返回的用户数量。返回相似度最高的几个用户，默认为1，最多返回20个。 |

## 人脸注册

------

```
|- 人脸库
   |- 用户组一
      |- 用户01
         |- 人脸
      |- 用户02
         |- 人脸
         |- 人脸
         ....
       ....
   |- 用户组二
   |- 用户组三
   |- 用户组四
   ....

```

/faceset/user/add 

用于向人脸库中新增用户，及组内用户的人脸图片，

典型应用场景：构建您的人脸库，如**会员人脸注册**，**已有用户补全人脸信息**等。

**请求参数**

| 参数       | 必选 | 类型   | 说明                                                         |
| ---------- | ---- | ------ | ------------------------------------------------------------ |
| image      | 是   | string | 图片信息(**总数据大小应小于10M**)，图片上传方式根据image_type来判断 |
| image_type | 是   | string | 图片类型 **BASE64**:图片的base64值，base64编码后的图片数据，编码后的图片大小不超过2M； **URL**:图片的 URL地址( 可能由于网络等原因导致下载图片时间过长)； **FACE_TOKEN**：人脸图片的唯一标识，调用人脸检测接口时，会为每个人脸图片赋予一个唯一的FACE_TOKEN，同一张图片多次检测得到的FACE_TOKEN是同一个。 |
| group_id   | 是   | string | 用户组id，标识一组用户（由数字、字母、下划线组成），长度限制48B。**产品建议**：根据您的业务需求，可以将需要注册的用户，按照业务划分，分配到不同的group下，例如按照会员手机尾号作为groupid，用于刷脸支付、会员计费消费等，这样可以尽可能控制每个group下的用户数与人脸数，提升检索的准确率 |
| user_id    | 是   | string | 用户id（由数字、字母、下划线组成），长度限制128B             |
| user_info  | 否   | string | 用户资料，长度限制48B 默认空                                 |





## 人脸更新

------

用于对人脸库中指定用户，更新其下的人脸图像。 

> **说明：**针对一个uid执行更新操作，新上传的人脸图像将覆盖此uid原有所有图像。 

/faceset/user/update

## 人脸删除

------

/faceset/face/delete 

删除用户的某一张人脸，如果该用户只有一张人脸图片，则同时删除用户。 



**请求参数**

| 参数       | 必选 | 类型   | 说明                                                         |
| ---------- | ---- | ------ | ------------------------------------------------------------ |
| user_id    | 是   | string | 用户id（由数字、字母、下划线组成），长度限制128B             |
| group_id   | 是   | string | 用户组id（由数字、字母、下划线组成） 长度限制48B，删除指定group_id中的user_id信息 |
| face_token | 是   | string | 需要删除的人脸图片token，（由数字、字母、下划线组成）长度限制64B |

## 用户信息查询

------

/faceset/user/get 

获取人脸库中某个用户的信息(user_info信息和用户所属的组)。 

## 获取用户人脸列表

------

/faceset/face/getlist 

用于获取一个用户的全部人脸列表。 

## 获取用户列表

------

/faceset/group/getusers 

用于查询指定用户组中的用户列表。 

## 复制用户

------

/faceset/user/copy 

用于将已经存在于人脸库中的用户**复制到一个新的组**。 

## 删除用户

------

/faceset/user/delete 

用于将用户从某个组中删除。 

## 创建用户组

------

/faceset/group/add 

用于创建一个空的用户组，如果用户组已存在 则返回错误。 

## 删除用户组

------

/faceset/group/delete 

删除用户组下所有的用户及人脸，如果组不存在 则返回错误 

## 组列表查询

------

/faceset/group/getlist 

用于查询用户组的列表。 